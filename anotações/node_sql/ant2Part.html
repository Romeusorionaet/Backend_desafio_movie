<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <title>Anotação 1</title>
    </head>
<body>
    
    <h1>movie.router.js</h1>

    <p>   
        Criamos uma pasta src e dentro dela a pasta routes/movie.router.js
    </p>

    <P>
        Dentro da pasta routes temos um arquivo index.js que exporta todas as rotas para o server.js 
        Melhor assim para não termos que importa direto no server cada rota que criarmos, o server.js 
        ficaria enorme. Fazendo isso é só importa o index.js da pasta desejada que nesse caso o router.
    </P>

    <P>
        No momento nosso arquivo index.js da pasta router está assim:
    </P>

    <P>
        const {Router} = requere("express");<br>
        
        const movieRouter = require("./movie.routes");<br>
        
        const routes = Router();<br>
        
        routes.use("/movie", movieRouter);<br>
        
        module.exports = routes; // exportamos routes pois ele tem toda a rota da nossa aplicação
    </P>

    <h2>Vamos entender a lógica até aqui</h2>

    <p>
        farei um fluxo:
    </p>

    <p>
        No insomnia quando clicamos non send irá para o:
        server.js em busca de uma rota nomeada na pesquisa no Insomnia: localhost:3333/movie
        movie será a rota que eu procuro.
    </p>

    <p> 
        const express = require('express'); //importamos o express<br>
        
        const routes = require("./routes") //n precisamos informar o index.js pois ele irá buscar por padrão<br>
        
        const app = express(); //inicializa o express<br>
        app.use(express.json()); //temos que informar que será do tipo json para o insomnia poder ler porque lá ta do tipo json também<br>
        
        app.use(routes); // AQUI ACHAMOS AS ROTAS<br>
        
        const PORT = 3333; <br>
        //atribuimos a uma const o indereço da porta na qual nossa api vai ficar observando<br>
        
        app.listen(PORT, ()=>{console.log(`Server is running on Port ${PORT}`)});<br>
        //Observa a port e execulta a messagem no terminal
    </p>

    <p>
        Entrando nas rotas entrará no index.js dentro da pasta rotas:
        index.js continuando a busca será encontrado /movie que é a rota que solicitei.
    </p>
<hr>
    <P>
        const {Router} = require("express");<br>
        
        const movieRouter = require("./movie.routes");<br>
        
        const routes = Router();<br>
        
        routes.use("/movie", movieRouter); // AQUI ENCONTREI O /MOVIE QUE FOI SOLICITADO<br>
        
        module.exports = routes;<br>
        <br>
        Encontrando o /movie ele entra no movieRouter que vem logo após o /movie <br>
        Isto foi uma ligação que fazemos para entrar no arquivo movie.router.js<br>
    </P>
<hr>
    <p>
        Entrando no arquivo movie.router.js<br>
        
        const {Router} = require("express");<br>
        
        const movieRoutes = Router();<br>
        
        movieRoutes.post("/", (req, res)=>{<br>
            const {name, description, note} = req.body;<br>
         
             res.json(`name movie: ${name} description: ${description} note: ${note}`);<br>
         });
         <br>
         module.exports = movieRoutes;
         <br>
         E aqui encotra a raiz "/" que é essa rota movie que quero. Então ele execulta 
         o movieRoutes.post()
    </p>
<hr>
    <p>
        DEIXANDO AQUI O FLUXO DE FORMA RESUMIDA:
        <br>
        iNSOMNIA: SEND => SERVER.JS => INDEX.JS => MOVIE.ROUTES.JS
    </p>    
</body>    
</html>